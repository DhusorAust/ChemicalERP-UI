<div class="bank-wrap">
  <!-- Header -->
  <div class="card card-head">
    <div class="card-header">
      <h2 class="title">Bank</h2>

      <div class="head-right" *ngIf="mode==='list'">
        <input class="form-control" placeholder="Search bank..." [(ngModel)]="search" (keyup.enter)="onSearchEnter()" name="searchBox">
        <div class="btn-group">
          <button type="button" class="btn btn-outline"
                  [class.btn-primary]="status==='ALL'" (click)="setStatus('ALL')">All</button>
          <button type="button" class="btn btn-outline"
                  [class.btn-primary]="status==='EDIT'" (click)="setStatus('EDIT')">Edit</button>
          <button type="button" class="btn btn-outline"
                  [class.btn-primary]="status==='APPROVED'" (click)="setStatus('APPROVED')">Approved</button>
        </div>
        <button type="button" class="btn btn-primary" (click)="openNew()">New</button>
      </div>

      <div class="head-right" *ngIf="mode==='form'">
        <button type="button" class="btn btn-outline" (click)="backToList()">← Back to list</button>
      </div>
    </div>
  </div>

  <!-- Alerts -->
  <div *ngIf="success && mode==='list'" class="alert info" style="margin-top:12px">{{ success }}</div>
  <div *ngIf="error" class="alert danger" style="margin-top:12px">{{ error }}</div>

  <!-- LIST (Grid) -->
  <div class="card" *ngIf="mode==='list'">
    <div class="card-body">
      <div *ngIf="loading" class="alert info">Loading...</div>

      <div class="table-responsive">
        <table class="table">
          <thead>
            <tr>
              <th (click)="toggleSort('BankID')" style="width:90px;cursor:pointer">
                ID <span *ngIf="sortField==='BankID'">{{ sortDir==='asc' ? '▲' : '▼' }}</span>
              </th>
              <th (click)="toggleSort('BankName')" style="cursor:pointer">
                BANK NAME <span *ngIf="sortField==='BankName'">{{ sortDir==='asc' ? '▲' : '▼' }}</span>
              </th>
              <th (click)="toggleSort('BankShortName')" style="cursor:pointer">
                SHORT <span *ngIf="sortField==='BankShortName'">{{ sortDir==='asc' ? '▲' : '▼' }}</span>
              </th>
              <th (click)="toggleSort('SwiftCode')" style="cursor:pointer">
                SWIFT <span *ngIf="sortField==='SwiftCode'">{{ sortDir==='asc' ? '▲' : '▼' }}</span>
              </th>
              <th (click)="toggleSort('BankAddress')" style="cursor:pointer">
                ADDRESS <span *ngIf="sortField==='BankAddress'">{{ sortDir==='asc' ? '▲' : '▼' }}</span>
              </th>
              <th (click)="toggleSort('IsActive')" style="width:90px;cursor:pointer">
                ACTIVE <span *ngIf="sortField==='IsActive'">{{ sortDir==='asc' ? '▲' : '▼' }}</span>
              </th>
              <th (click)="toggleSort('Approved')" style="width:110px;cursor:pointer">
                APPROVED <span *ngIf="sortField==='Approved'">{{ sortDir==='asc' ? '▲' : '▼' }}</span>
              </th>
            </tr>
          </thead>

          <tbody>
            <tr *ngFor="let r of items">
              <td>{{ r.BankID }}</td>
              <td class="text-strong">{{ r.BankName }}</td>
              <td>{{ r.BankShortName || '—' }}</td>
              <td>{{ r.SwiftCode || '—' }}</td>
              <td>{{ r.BankAddress || '—' }}</td>
              <td>{{ (r.IsActive ? 1 : 0) ? 'Yes' : 'No' }}</td>
              <td>{{ (r.Approved ? 1 : 0) ? 'Yes' : 'No' }}</td>
            </tr>

            <tr *ngIf="!items.length && !loading">
              <td colspan="7" class="empty">NO DATA FOUND</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="card-footer">
        <div class="text-muted">Total: {{ total }}</div>
      </div>
    </div>
  </div>

  <!-- FORM (Create) -->
  <div class="card" *ngIf="mode==='form'">
    <div class="card-body">
      <form (ngSubmit)="submit()">
        <div class="form-grid">
          <label>
            <div>Bank Name <span class="req">*</span></div>
            <input class="form-control" name="BankName" [(ngModel)]="form.BankName" required />
          </label>

          <label>
            <div>Short Name</div>
            <input class="form-control" name="BankShortName" [(ngModel)]="form.BankShortName" />
          </label>

          <label>
            <div>SWIFT</div>
            <input class="form-control" name="SwiftCode" [(ngModel)]="form.SwiftCode" />
          </label>

          <label class="col-span-2">
            <div>Address</div>
            <input class="form-control" name="BankAddress" [(ngModel)]="form.BankAddress" />
          </label>

          <label>
            <div>Active</div>
            <select class="form-control" name="IsActive" [(ngModel)]="form.IsActive">
              <option [ngValue]="1">Yes</option>
              <option [ngValue]="0">No</option>
            </select>
          </label>

          <label>
            <div>Approved</div>
            <select class="form-control" name="Approved" [(ngModel)]="form.Approved">
              <option [ngValue]="1">Yes</option>
              <option [ngValue]="0">No</option>
            </select>
          </label>
        </div>

        <div class="card-footer" style="justify-content:space-between">
          <button type="button" class="btn" (click)="backToList()">← Back to list</button>
          <button type="submit" class="btn btn-primary" [disabled]="saving">
            {{ saving ? 'Saving…' : 'Save' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
